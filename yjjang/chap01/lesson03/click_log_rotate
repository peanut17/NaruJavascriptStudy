
ì¢‹ìŠµë‹ˆë‹¤ ğŸ‘ ì •ë¦¬í•´ ë“œë¦¬ë©´, ClickHouse ìì²´ config.xmlì€ ë‚ ì§œë³„ íŒŒì¼ ìƒì„±ì„ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— logrotateë¥¼ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤. logrotate ì„¤ì •ì—ì„œ daily + rotate 30 + dateext + dateformatì„ ì§€ì •í•˜ë©´ ì›í•˜ëŠ” ëŒ€ë¡œ ë©ë‹ˆë‹¤.


---

ğŸ“Œ logrotate ì„¤ì • ë°©ë²•

1. ì„¤ì • íŒŒì¼ ìƒì„±/ìˆ˜ì •
/etc/logrotate.d/clickhouse-server íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ ë‚´ìš©ì„ ë„£ìœ¼ì„¸ìš”:



/var/log/clickhouse-server/clickhouse-server.log
/var/log/clickhouse-server/clickhouse-server.err.log {
    daily                  # í•˜ë£¨ ë‹¨ìœ„ íšŒì „
    rotate 30              # ìµœëŒ€ 30ê°œ ë³´ê´€ (â‰ˆ 30ì¼ì¹˜)
    dateext                # íšŒì „ë³¸ íŒŒì¼ëª…ì— ë‚ ì§œ ì ‘ë¯¸ì‚¬ ì¶”ê°€
    dateformat -%Y-%m-%d   # ì ‘ë¯¸ì‚¬ í˜•ì‹: -YYYY-MM-DD
    compress               # ì§€ë‚œ ë¡œê·¸ gzip ì••ì¶•
    delaycompress          # ë§‰ íšŒì „í•œ ë¡œê·¸ëŠ” ë‹¤ìŒ íšŒì „ ë•Œ ì••ì¶•
    missingok              # ë¡œê·¸ ì—†ìœ¼ë©´ ë¬´ì‹œ
    notifempty             # ë¹„ì–´ ìˆìœ¼ë©´ íšŒì „ ì•ˆ í•¨
    maxsize 200M           # í•˜ë£¨ ì „ì—ë¼ë„ 200MB ë„˜ìœ¼ë©´ íšŒì „
    copytruncate           # ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ ê¸°ì¡´ íŒŒì¼ ë¹„ìš°ê¸°
}

ğŸ‘‰ copytruncate ëŒ€ì‹  postrotate+systemctl kill -s HUP clickhouse-serverë¥¼ ì“¸ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. (í™˜ê²½ì— ë”°ë¼ ì„ íƒ)


---

ğŸ“Œ ë™ì‘ í™•ì¸

ìˆ˜ë™ íšŒì „ í…ŒìŠ¤íŠ¸


sudo logrotate -f /etc/logrotate.d/clickhouse-server

ë””ë²„ê·¸ ëª¨ë“œ (ì‹¤ì œ íšŒì „ ì•ˆ í•¨)


sudo logrotate -d /etc/logrotate.d/clickhouse-server

ìë™ ì‹¤í–‰
UbuntuëŠ” systemd timer ë˜ëŠ” cron.daily/logrotateë¡œ í•˜ë£¨ 1íšŒ ìë™ ì‹¤í–‰ë©ë‹ˆë‹¤.



---

ğŸ“Œ ë‚ ì§œë³„ ìƒì„±ë˜ëŠ” ë¡œê·¸íŒŒì¼ ì˜ˆì‹œ

íšŒì „ í›„ /var/log/clickhouse-server/ì— ì•„ë˜ì²˜ëŸ¼ ìŒ“ì…ë‹ˆë‹¤:

clickhouse-server.log              â† í˜„ì¬ ë¡œê·¸ íŒŒì¼ (ì‹¤ì‹œê°„ ê¸°ë¡ ì¤‘)
clickhouse-server.log-2025-09-30.gz â† 2025ë…„ 9ì›” 30ì¼ íšŒì „ë³¸
clickhouse-server.log-2025-10-01.gz â† 2025ë…„ 10ì›” 1ì¼ íšŒì „ë³¸
clickhouse-server.log-2025-10-02.gz â† 2025ë…„ 10ì›” 2ì¼ íšŒì „ë³¸
...

clickhouse-server.err.log
clickhouse-server.err.log-2025-09-30.gz
clickhouse-server.err.log-2025-10-01.gz
clickhouse-server.err.log-2025-10-02.gz
...

.logì™€ .err.logëŠ” í•­ìƒ ìµœì‹  ë¡œê·¸

-YYYY-MM-DD.gzëŠ” ë‚ ì§œë³„ ë³´ê´€ íŒŒì¼

30ì¼ì´ ì§€ë‚˜ë©´ ê°€ì¥ ì˜¤ë˜ëœ íŒŒì¼ë¶€í„° ìë™ ì‚­ì œë¨



---

ğŸ‘‰ ì›í•˜ì‹œë©´ ì œê°€ server.log, err.log, text_log.log, trace_log.logê¹Œì§€ í•œ ë²ˆì— 30ì¼ ë³´ê´€í•˜ëŠ” ì™„ì„±í˜• ìŠ¤ë‹ˆí«ë„ ë§Œë“¤ì–´ ë“œë¦´ ìˆ˜ ìˆì–´ìš”. ê·¸ëŸ´ê¹Œìš”?

