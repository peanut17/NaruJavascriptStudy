í•„ìš”í•œ í…Œì´ë¸”ë§Œ í•„í„°ë§í•˜ë ¤ë©´ if ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” í…Œì´ë¸”ë§Œ ë¦¬ìŠ¤íŠ¸ì— í¬í•¨ì‹œí‚¤ë©´ ë¼. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • í…Œì´ë¸” ëª©ë¡ì„ allowed_tablesì— ì €ì¥í•˜ê³  í•„í„°ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì–´.

python
ë³µì‚¬
í¸ì§‘
def collectTableField(self, partition):
    allowed_tables = {"table1", "table2", "table3"}  # í•„ìš”í•œ í…Œì´ë¸” ëª©ë¡
    return [row['table'] for row in partition if row['table'] in allowed_tables]
ì´ë ‡ê²Œ í•˜ë©´ allowed_tablesì— í¬í•¨ëœ í…Œì´ë¸”ë§Œ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ë  ê±°ì•¼.
í•„ìš”í•œ í…Œì´ë¸” ëª©ë¡ì„ ë™ì ìœ¼ë¡œ ê°€ì ¸ì™€ì•¼ í•œë‹¤ë©´, ì™¸ë¶€ ì„¤ì • íŒŒì¼ì´ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì½ì–´ì˜¤ëŠ” ë°©ì‹ë„ ê³ ë ¤í•  ìˆ˜ ìˆì–´. ğŸ˜Š




ChatGPTì˜ ë§:
í•„í„°ë§ëœ í…Œì´ë¸”ì„ ì¶œë ¥í•˜ëŠ” print ì½”ë“œë¥¼ ì¶”ê°€í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆì–´:

python
ë³µì‚¬
í¸ì§‘
def collectTableField(self, partition):
    allowed_tables = {"table1", "table2", "table3"}  # í•„ìš”í•œ í…Œì´ë¸” ëª©ë¡
    filtered_tables = [row['table'] for row in partition if row['table'] in allowed_tables]

    for table in filtered_tables:
        print(f"Selected Table: {table}")

    return filtered_tables
ì´ë ‡ê²Œ í•˜ë©´ í•„í„°ë§ëœ í…Œì´ë¸”ì´ í•˜ë‚˜ì”© Selected Table: table_name í˜•íƒœë¡œ ì¶œë ¥ë  ê±°ì•¼.
ë” ë§ì€ ì •ë³´ê°€ í•„ìš”í•˜ë©´ print(row)ë¥¼ ì¶”ê°€í•´ì„œ ì „ì²´ í–‰ì„ ì¶œë ¥í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•´! 




def _getTableNames(self, df):
    tableNames = df.select('table').rdd.mapPartitions(self.collectTableField).distinct()
    
    # í…Œì´ë¸” ì¶œë ¥
    for table in tableNames.collect():
        print(f"Selected Table: {table}")

    return tableNames.collect()
-----

import logging

logging.basicConfig(level=logging.INFO)

name = "Alice"
age = 25

logging.info(f"User {name} is {age} years old.")

-----

logging.info("User %(name)s is %(age)d years old.", {"name": name, "age": age})


-----
name = "Alice"
age = 25

print(f"Hello, my name is {name} and I am {age} years old.")

-------
df.show()  # ê¸°ë³¸ 20ê°œ í–‰ ì¶œë ¥
df.show(n=50, truncate=False)  # 50ê°œ í–‰ ì¶œë ¥, ì»¬ëŸ¼ ìƒëµ ì—†ì´
df.printSchema()  # ìŠ¤í‚¤ë§ˆ í™•ì¸
df.columns  # ì»¬ëŸ¼ ì´ë¦„ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
df.describe().show()  # í†µê³„ ìš”ì•½


----------
from pyspark.sql.functions import col

valid_tables = ["payload", "nopayload", "event", "log", "error", "click", "view", "user", "metric", "summary", "trace", "debug"]

# í•„í„°ë§: table ì»¬ëŸ¼ì˜ ê°’ì´ ë¦¬ìŠ¤íŠ¸ì— í¬í•¨ëœ ê²ƒë§Œ ë‚¨ê¹€
filtered_df = df.filter(col("table").isin(valid_tables))
